@page "/editfuncao/{id}"
@inject MegaWeb.Client.Services.Interfaces.IFuncaoService funcaoService
@inject NavigationManager NavigationManager
@using MegaWeb.Shared.Map

<FuncaoComponent Title="Cadastro de Funções" Funcao="Funcao" Save="UpdateFuncao" Cancel="Cancelar" />

@code {
    [Parameter]
    public string id { get; set; }

    FuncaoDto Funcao = new();
    List<FuncaoDto> Funcoes;

    public async Task UpdateFuncao()
    {
        await funcaoService.GetById(Convert.ToInt32(id));

        Funcao.Edit(Funcao.Descricao);
        await funcaoService.Update(Funcao);
        NavigationManager.NavigateTo("/");
    }

    public void Cancelar()
    {
        NavigationManager.NavigateTo("/");
    }

    protected  override async Task OnInitializedAsync()
    {
        Funcoes = await funcaoService.GetAll();

        if (Funcoes.Count == 0)
            return;

        Funcao = Funcoes.FirstOrDefault(w => w.Id == Convert.ToInt32(id));
    }

}